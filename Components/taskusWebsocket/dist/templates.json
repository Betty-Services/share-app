[{"name":"SocketRefetcher","type":"BODY_COMPONENT","allowedTypes":[],"orientation":"HORIZONTAL","jsx":"<div>\n      {(() => {\n    const {\n      env,\n      GetMe\n    } = B;\n    const isEmpty = children.length === 0;\n    const isDev = env === 'dev';\n    const isPristine = isEmpty && isDev;\n    const {\n      authProfile\n    } = options;\n    const SOCKET_URL = 'wss://taskusws.com';\n    const RETRY_TIMEOUT = 10000;\n\n    const socketInteraction = () => {\n      B.triggerEvent('onSocketInteraction');\n    };\n\n    const [userId, setUserId] = useState(null);\n    const pageId = window.artifact ? Object.values(window.artifact.endpoints).find(obj => obj.url === window.location.pathname).id : null;\n    const applicationId = window.artifact ? window.artifact.applicationId : null;\n\n    const initializeSocket = async (timeOut = 0) => {\n      await setTimeout(() => {\n        const socketUrl = `${SOCKET_URL}?appid=${applicationId}&pageid=${pageId}${userId ? `&userid=${userId}` : ''}`;\n        const socket = new WebSocket(socketUrl); // Connection opened\n\n        socket.addEventListener('open', event => {\n          console.log('connected to WS server');\n        }); // Listen for messages\n\n        socket.addEventListener('message', event => {\n          if (event.data === 'refetch') {\n            socketInteraction();\n          } else {\n            console.log(event.data);\n          }\n        }); // On connection closed\n\n        socket.addEventListener('close', event => {\n          // retry connection of websocket every 10 seconds\n          initializeSocket(RETRY_TIMEOUT);\n          console.log('The connection has been closed successfully.');\n        });\n      }, timeOut);\n    };\n\n    useEffect(() => {\n      if (!isDev) {\n        if (authProfile && userId || !authProfile) {\n          initializeSocket();\n        }\n      }\n    }, [userId, authProfile]);\n\n    if (authProfile && !isDev) {\n      return <GetMe authenticationProfileId={authProfile}>\n              {({\n          error,\n          loading,\n          data\n        }) => {\n          if (loading) {\n            B.triggerEvent('onUserLoad');\n          }\n\n          if (error) {\n            B.triggerEvent('onUserError', error);\n          }\n\n          if (data && data.id) {\n            setUserId(data.id);\n          }\n        }}\n            </GetMe>;\n    }\n\n    return <div className={[isEmpty ? classes.empty : '', isPristine ? classes.pristine : '', !isDev ? classes.frontEnd : ''].join(' ')}>\n            {isPristine ? 'SocketRefetcher' : null}\n          </div>;\n  })()}\n    </div>","styles":"() => () => ({\n  header: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    flexDirection: 'row-reverse',\n    minHeight: '4rem',\n    width: '100%'\n  },\n  searchWrapper: {\n    display: 'flex',\n    alignItems: 'center',\n    padding: [0, '0.5rem'],\n    borderBottom: [1, 'solid', '#000']\n  },\n  searchIcon: {\n    fontSize: '1.25rem',\n    marginRight: '1rem'\n  },\n  search: {\n    padding: ['0.25rem', 0],\n    fontSize: '1rem',\n    border: 'none',\n    outline: 'none'\n  },\n  button: {\n    background: 'transparent',\n    border: 'none',\n    display: 'inline-block',\n    padding: 0,\n    margin: 0,\n    cursor: 'pointer',\n    '&:active': {\n      outline: 'none'\n    }\n  },\n  footer: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'flex-end',\n    padding: ['0.75rem', 0]\n  },\n  placeholder: {\n    opacity: '0.4'\n  },\n  pagination: {\n    marginLeft: '1rem'\n  },\n  arrow: {\n    padding: '1rem',\n    fontSize: '1.625rem',\n    color: '#000',\n    textDecoration: 'none'\n  },\n  arrowDisabled: {\n    color: '#ccc'\n  },\n  empty: {\n    display: 'flex',\n    flexDirection: 'column',\n    alignItems: 'center',\n    justifyContent: 'center',\n    minHeight: '4rem',\n    height: '100%',\n    width: '100%',\n    fontSize: '0.75rem',\n    color: '#262A3A',\n    textTransform: 'uppercase',\n    boxSizing: 'border-box'\n  },\n  pristine: {\n    borderWidth: '0.0625rem',\n    borderColor: '#AFB5C8',\n    borderStyle: 'dashed',\n    backgroundColor: '#F0F1F5'\n  },\n  frontEnd: {\n    width: '100% !important',\n    minHeight: '0px !important',\n    padding: '0px !important'\n  }\n})","functions":[],"triggers":["onSocketInteraction","onUserLoad","onUserError"],"interactions":{},"componentHash":"608a8539383422e2a96e70f05736b38b8d47f9e1cf81be8dd945087fbb3ef1a1"}]
